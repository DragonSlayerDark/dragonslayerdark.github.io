{"ast":null,"code":"import { select } from '@ngrx/store';\nimport { PAWLLocalStorage } from 'src/app/exports/enums';\nimport { selectAllPets, selectPetById } from 'src/app/store/entities/selectors/pet.selectors';\nimport { HeaderChildAbstract } from '../header-child-abstract/header-child-abstract.component';\nimport { getCartLength } from 'src/app/store/custom/selectors/cart.selectors';\nimport { tap, filter, map } from 'rxjs';\nimport { loadPets } from 'src/app/store/entities/actions/pet.actions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/auth_services/store/auth.service\";\nimport * as i4 from \"src/app/store/entities/services/pet.service\";\nimport * as i5 from \"src/app/store/custom/services/app.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../../pipes/image.pipe\";\n\nfunction HeaderShopComponent_ng_container_3_div_4_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"span\", 19);\n    i0.ɵɵlistener(\"click\", function HeaderShopComponent_ng_container_3_div_4_span_9_Template_span_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const item_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r9.changePet(item_r8.id, item_r8.attributes.pet_type.data[\"id\"]));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"br\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r8 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", item_r8.attributes.name, \" \");\n  }\n}\n\nfunction HeaderShopComponent_ng_container_3_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 13);\n    i0.ɵɵtext(2, \" Tienda \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 14)(4, \"label\", 15);\n    i0.ɵɵtext(5);\n    i0.ɵɵelement(6, \"input\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 17)(8, \"p\");\n    i0.ɵɵtemplate(9, HeaderShopComponent_ng_container_3_div_4_span_9_Template, 3, 1, \"span\", 18);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const data_r6 = ctx.ngIf;\n    const pet_r4 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(pet_r4.attributes.name);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", data_r6.pets);\n  }\n}\n\nconst _c0 = function () {\n  return {\n    \"border-color\": \"#45B45A\"\n  };\n};\n\nconst _c1 = function (a0) {\n  return {\n    pets: a0\n  };\n};\n\nfunction HeaderShopComponent_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 9);\n    i0.ɵɵelement(2, \"img\", 10);\n    i0.ɵɵpipe(3, \"image\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, HeaderShopComponent_ng_container_3_div_4_Template, 10, 2, \"div\", 11);\n    i0.ɵɵpipe(5, \"async\");\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const pet_r4 = ctx.ngIf;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction0(7, _c0))(\"src\", i0.ɵɵpipeBind1(3, 3, pet_r4.attributes[\"photo\"].data == null ? null : pet_r4.attributes[\"photo\"].data.attributes == null ? null : pet_r4.attributes[\"photo\"].data.attributes.url), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpureFunction1(8, _c1, i0.ɵɵpipeBind1(5, 5, ctx_r0.pets$)));\n  }\n}\n\nfunction HeaderShopComponent_ng_container_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"span\", 20);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"async\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(3, 1, ctx_r1.cartItemsLength), \" \");\n  }\n}\n\nfunction HeaderShopComponent_ng_template_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 20);\n    i0.ɵɵtext(1, \" 0 \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let HeaderShopComponent = /*#__PURE__*/(() => {\n  class HeaderShopComponent extends HeaderChildAbstract {\n    constructor(store, router, auth, petService, app) {\n      super();\n      this.store = store;\n      this.router = router;\n      this.auth = auth;\n      this.petService = petService;\n      this.app = app;\n      this.cartItemsLength = this.store.pipe(select(getCartLength));\n      this.selectedPet$ = null;\n      this.selectedPetID = localStorage.getItem(PAWLLocalStorage.SELECTED_PET_ID);\n      this.cart = localStorage.getItem('cart');\n    }\n\n    ngOnInit() {\n      this.store.dispatch(loadPets({\n        userID: this.auth.getUser().id\n      }));\n      this.pet$ = this.store.pipe(select(selectPetById(this.selectedPetID)), tap(x => console.log(x)));\n      this.pets$ = this.store.select(selectAllPets).pipe(filter(x => x.length != 0), map(pets => {\n        let selectedPetID = localStorage.getItem(PAWLLocalStorage.SELECTED_PET_ID) || pets[0].id;\n        let modifiedPets = [...pets];\n\n        if (selectedPetID) {\n          // Find the selected pet and remove it from the array\n          let selectedPet = modifiedPets.find(pet => pet.id == selectedPetID);\n          modifiedPets = modifiedPets.filter(pet => pet.id != selectedPet.id);\n        }\n\n        return modifiedPets;\n      }));\n    }\n\n    goToCart() {\n      this.router.navigate(['/shop/cart']);\n    }\n\n    changePet(petId, petTypeId) {\n      this.petService.setPet(petId = petId, petTypeId = petTypeId);\n      this.router.navigate(['/shop', 'products']).then(() => {\n        location.reload();\n      });\n    }\n\n  }\n\n  HeaderShopComponent.ɵfac = function HeaderShopComponent_Factory(t) {\n    return new (t || HeaderShopComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.PetService), i0.ɵɵdirectiveInject(i5.AppService));\n  };\n\n  HeaderShopComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HeaderShopComponent,\n    selectors: [[\"app-header-shop\"]],\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 12,\n    vars: 7,\n    consts: [[1, \"grid\", \"grid-cols-12\", \"gap-4\", \"m-6\", \"mt-8\", \"mb-0\"], [1, \"col-span-1\", \"flex\", \"items-center\", \"justify-center\", 3, \"click\"], [\"src\", \"assets/back.svg\", 1, \"w-7\"], [4, \"ngIf\"], [1, \"col-span-2\", \"flex\", \"items-center\", \"justify-center\"], [1, \"flex\", 3, \"click\"], [\"src\", \"assets/icons/shopcart.svg\", 1, \"h-6\", \"float-right\", \"m-2\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseTemplate\", \"\"], [1, \"col-span-4\", \"flex\", \"items-center\", \"justify-center\"], [1, \"h-20\", \"w-20\", \"rounded-full\", \"object-cover\", \"border-4\", \"object-top\", \"bg-white\", 3, \"ngStyle\", \"src\"], [\"class\", \"col-span-4 items-center justify-center\", 4, \"ngIf\"], [1, \"col-span-4\", \"items-center\", \"justify-center\"], [1, \"col-span-1\", \"font-bold\", \"text-2xl\", \"text-left\", 2, \"color\", \"#ffffff\"], [1, \"accordeon\"], [1, \"accordeon_link\"], [\"type\", \"checkbox\"], [1, \"accordeon_item\"], [\"class\", \"accordeon_option\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"accordeon_option\", 3, \"click\"], [1, \"cartitems-number\"]],\n    template: function HeaderShopComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵlistener(\"click\", function HeaderShopComponent_Template_div_click_1_listener() {\n          return ctx.back();\n        });\n        i0.ɵɵelement(2, \"img\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, HeaderShopComponent_ng_container_3_Template, 6, 10, \"ng-container\", 3);\n        i0.ɵɵpipe(4, \"async\");\n        i0.ɵɵelementStart(5, \"div\", 4)(6, \"div\", 5);\n        i0.ɵɵlistener(\"click\", function HeaderShopComponent_Template_div_click_6_listener() {\n          return ctx.goToCart();\n        });\n        i0.ɵɵelement(7, \"img\", 6);\n        i0.ɵɵtemplate(8, HeaderShopComponent_ng_container_8_Template, 4, 3, \"ng-container\", 7);\n        i0.ɵɵpipe(9, \"async\");\n        i0.ɵɵtemplate(10, HeaderShopComponent_ng_template_10_Template, 2, 0, \"ng-template\", null, 8, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        const _r2 = i0.ɵɵreference(11);\n\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(4, 3, ctx.selectedPetID && ctx.pet$));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(9, 5, ctx.cartItemsLength))(\"ngIfElse\", _r2);\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i6.NgStyle, i6.AsyncPipe, i7.ImagePipe]\n  });\n  return HeaderShopComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}